# 数据质量管理 - 演示数据说明

## 概述
数据质量管理页面已配置完整的演示数据，包括质量规则、检查历史和质量工单。

## 数据统计

### 质量规则（20条）
- **完整性规则**: 4条
- **准确性规则**: 8条
- **一致性规则**: 4条
- **唯一性规则**: 3条
- **合理性规则**: 3条
- **及时性规则**: 0条

### 检查历史（20条）
- **通过检查**: 19条
- **失败检查**: 1条
- **平均质量评分**: 96.5分

### 质量工单（15条）
- **待处理**: 5条
- **已分配**: 6条
- **处理中**: 3条
- **已解决**: 2条

## 详细数据说明

### 1. 质量规则示例

#### QR001 - 学生身份证号完整性检查
- **类型**: 完整性
- **目标表**: student_info
- **目标字段**: id_card
- **严重程度**: 高
- **阈值**: 95%
- **规则表达式**: `id_card IS NOT NULL AND LENGTH(id_card) = 18`
- **最后评分**: 98.5分
- **状态**: 通过

#### QR002 - 手机号格式校验
- **类型**: 准确性
- **目标表**: student_info
- **目标字段**: phone
- **严重程度**: 中
- **阈值**: 90%
- **规则表达式**: `phone REGEXP '^1[3-9][0-9]{9}$'`
- **最后评分**: 92.3分
- **状态**: 通过

#### QR003 - 财务金额一致性检查
- **类型**: 一致性
- **目标表**: financial_transaction
- **目标字段**: amount
- **严重程度**: 高
- **阈值**: 99%
- **规则表达式**: `amount = debit_amount - credit_amount`
- **最后评分**: 99.8分
- **状态**: 通过

#### QR006 - 邮箱格式验证（失败案例）
- **类型**: 准确性
- **目标表**: student_info
- **目标字段**: email
- **严重程度**: 低
- **阈值**: 80%
- **规则表达式**: `email REGEXP '^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}$'`
- **最后评分**: 75.2分
- **状态**: 失败 ❌

### 2. 涉及的数据表

| 表名 | 检查次数 | 平均评分 | 通过次数 | 失败次数 | 通过率 |
|------|----------|----------|----------|----------|--------|
| student_info | 6 | 93.5 | 5 | 1 | 83.3% |
| financial_transaction | 2 | 99.5 | 2 | 0 | 100% |
| teacher_info | 2 | 98.8 | 2 | 0 | 100% |
| research_project | 3 | 98.5 | 3 | 0 | 100% |
| procurement_project | 2 | 94.2 | 2 | 0 | 100% |
| asset_info | 1 | 98.8 | 1 | 0 | 100% |
| supplier_info | 1 | 100 | 1 | 0 | 100% |
| contract_info | 1 | 94.2 | 1 | 0 | 100% |
| invoice_info | 1 | 98.5 | 1 | 0 | 100% |
| department_info | 1 | 96.0 | 1 | 0 | 100% |

### 3. 检查历史示例

#### CHK001 - 学生身份证号完整性检查
- **检查时间**: 2024-10-23 08:00:00
- **总记录数**: 15,000
- **通过记录**: 14,775
- **失败记录**: 225
- **质量评分**: 98.5分
- **状态**: 通过 ✅
- **耗时**: 1,250ms

#### CHK004 - 邮箱格式验证（失败案例）
- **检查时间**: 2024-10-23 08:00:00
- **总记录数**: 15,000
- **通过记录**: 11,280
- **失败记录**: 3,720
- **质量评分**: 75.2分
- **状态**: 失败 ❌
- **耗时**: 850ms

### 4. 质量工单示例

#### TK001 - 学生邮箱格式问题批量修复
- **规则**: QR006 - 邮箱格式验证
- **严重程度**: 低
- **状态**: 待处理
- **影响记录**: 3,720条
- **描述**: 检测到3720条学生邮箱格式不正确，需要批量修复
- **创建时间**: 2024-10-23 08:15:00

#### TK003 - 身份证号缺失数据补录
- **规则**: QR001 - 学生身份证号完整性检查
- **严重程度**: 高
- **状态**: 处理中
- **分配给**: 李四
- **影响记录**: 225条
- **描述**: 225名学生身份证号信息缺失，需要补录
- **创建时间**: 2024-10-23 08:05:00

#### TK004 - 财务金额不一致问题核查（已解决）
- **规则**: QR003 - 财务金额一致性检查
- **严重程度**: 高
- **状态**: 已解决 ✅
- **分配给**: 王五
- **影响记录**: 100条
- **描述**: 100笔财务交易金额与借贷金额不一致，已核查并修正
- **创建时间**: 2024-10-23 07:45:00
- **解决时间**: 2024-10-23 11:30:00

## 规则类型说明

### 完整性（Completeness）
检查数据是否完整，没有缺失值。
- 示例：身份证号非空检查、姓名非空检查、资产价值非空检查

### 准确性（Accuracy）
检查数据格式和值是否准确、符合规范。
- 示例：手机号格式校验、邮箱格式验证、职称有效性检查

### 一致性（Consistency）
检查相关数据之间是否一致、逻辑是否正确。
- 示例：财务金额一致性、项目时间逻辑、经费余额合理性

### 唯一性（Uniqueness）
检查数据是否唯一，没有重复。
- 示例：教师ID唯一性、资产编号唯一性、供应商信用代码唯一性

### 有效性（Validity）
检查数据值是否在有效范围内。
- 示例：项目状态有效性、部门编码标准化

### 及时性（Timeliness）
检查数据是否及时更新。
- 当前演示数据中暂无此类规则

## 质量趋势数据

最近7天的平均质量评分：

| 日期 | 平均评分 |
|------|----------|
| 10-17 | 95.2 |
| 10-18 | 94.8 |
| 10-19 | 96.1 |
| 10-20 | 95.5 |
| 10-21 | 96.3 |
| 10-22 | 95.8 |
| 10-23 | 96.5 |

**趋势**: 整体呈上升趋势，质量管理效果良好 📈

## 新建规则功能

### 支持的规则类型
1. **完整性（COMPLETENESS）** - 检查数据完整性
2. **准确性（ACCURACY）** - 检查数据准确性
3. **一致性（CONSISTENCY）** - 检查数据一致性
4. **唯一性（UNIQUENESS）** - 检查数据唯一性
5. **有效性（VALIDITY）** - 检查数据有效性
6. **及时性（TIMELINESS）** - 检查数据及时性

### 严重程度
- **高（HIGH）** - 严重影响数据质量，需要立即处理
- **中（MEDIUM）** - 中等影响，需要及时处理
- **低（LOW）** - 轻微影响，可以延后处理

### 表单字段
- **规则名称**（必填）：规则的唯一标识名称
- **规则类型**（必填）：从6种类型中选择
- **严重程度**（必填）：高/中/低
- **目标表**（必填）：要检查的数据表名
- **目标字段**（可选）：要检查的字段名
- **阈值**（必填）：质量评分阈值（0-100），默认95
- **规则表达式**（可选）：SQL WHERE条件表达式
- **描述**（可选）：规则的详细描述

### 创建规则示例

#### 示例1：检查学号非空
```
规则名称: 学号完整性检查
规则类型: 完整性
严重程度: 高
目标表: student_info
目标字段: student_no
阈值: 100
规则表达式: student_no IS NOT NULL AND LENGTH(student_no) > 0
描述: 检查学生学号是否为空
```

#### 示例2：检查成绩范围
```
规则名称: 成绩合理性检查
规则类型: 有效性
严重程度: 中
目标表: student_score
目标字段: score
阈值: 95
规则表达式: score >= 0 AND score <= 100
描述: 检查学生成绩是否在0-100分之间
```

## 数据更新说明

### 自动生成的字段
创建新规则时，以下字段会自动生成：
- **规则ID**: 格式为 QR + 3位数字（如 QR021）
- **创建时间**: 当前系统时间
- **启用状态**: 默认为启用
- **最后检查时间**: 初始为空
- **最后评分**: 初始为空
- **状态**: 初始为空

### 数据持久化
当前演示数据存储在浏览器内存中，刷新页面后会重置。
生产环境中应该连接后端API进行数据持久化。

## 使用建议

1. **先查看现有规则** - 了解已配置的规则类型和检查逻辑
2. **查看检查历史** - 了解各规则的执行情况和质量评分
3. **处理质量工单** - 优先处理高严重程度的待处理工单
4. **创建新规则** - 根据业务需求创建新的质量检查规则
5. **监控质量趋势** - 定期查看质量看板，关注质量变化趋势

## 技术实现

### 数据服务（data-quality-service.js）
- `getRules()` - 获取规则列表（支持筛选）
- `getChecks()` - 获取检查历史（支持筛选）
- `getTickets()` - 获取质量工单（支持筛选）
- `getStatistics()` - 获取统计数据
- `getTableStats()` - 获取按表统计数据
- `getRuleTypeStats()` - 获取按规则类型统计
- `getTrendData()` - 获取趋势数据
- `createRule()` - 创建新规则 ✨
- `updateRule()` - 更新规则
- `deleteRule()` - 删除规则
- `getRuleById()` - 获取规则详情

### 页面管理（data-quality-management.js）
- `init()` - 初始化页面
- `switchTab()` - 切换标签页
- `loadRules()` - 加载规则列表
- `loadChecks()` - 加载检查历史
- `loadTickets()` - 加载质量工单
- `showCreateRuleModal()` - 显示创建规则模态框 ✨
- `closeCreateRuleModal()` - 关闭模态框
- `submitRule()` - 提交规则表单 ✨

## 状态
✅ 演示数据已完整配置
✅ 新建规则功能已实现
✅ 所有功能正常运行
