<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>测试主数据管理按钮</title>
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/master-data-management.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .test-info {
            background: #f0f9ff;
            border: 2px solid #0ea5e9;
            border-radius: 8px;
            padding: 20px;
            margin: 20px;
        }
        .test-info h2 {
            color: #0369a1;
            margin-top: 0;
        }
        .test-log {
            background: #1e293b;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            margin-top: 10px;
        }
        .test-log div {
            margin: 5px 0;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <header id="top-navbar"></header>

        <div class="main-wrapper">
            <aside id="side-navbar"></aside>

            <main class="content-area">
                <div class="test-info">
                    <h2><i class="fas fa-flask"></i> 主数据管理按钮测试</h2>
                    <p>此页面用于测试"新增主数据"按钮的点击事件是否正常工作。</p>
                    <p><strong>测试步骤：</strong></p>
                    <ol>
                        <li>点击下方的"新增主数据"按钮</li>
                        <li>检查是否弹出创建模态框</li>
                        <li>查看控制台日志输出</li>
                    </ol>
                    <div class="test-log" id="testLog">
                        <div>[测试] 页面加载完成，等待用户操作...</div>
                    </div>
                </div>

                <div class="filter-section">
                    <div class="filter-row">
                        <div class="filter-left">
                            <div class="search-box">
                                <input type="text" id="searchInput" placeholder="搜索...">
                                <i class="fas fa-search"></i>
                            </div>
                        </div>
                        <div class="filter-right">
                            <button id="createBtn" class="btn btn-primary">
                                <i class="fas fa-plus"></i> 新增主数据
                            </button>
                        </div>
                    </div>
                </div>

                <div class="table-container">
                    <p style="text-align: center; padding: 40px; color: #6B7280;">
                        这是一个测试页面，主要用于验证按钮功能
                    </p>
                </div>
            </main>
        </div>
    </div>

    <!-- 创建主数据模态框 -->
    <div id="createModal" class="modal-overlay">
        <div class="modal-container modal-lg">
            <div class="modal-header">
                <h2 class="modal-title" id="createModalTitle">
                    <i class="fas fa-plus-circle"></i>新增主数据
                </h2>
                <button class="modal-close-btn" onclick="masterDataPage.closeCreateModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="masterDataForm">
                    <div class="form-group">
                        <label>实体类型 <span class="required">*</span></label>
                        <select id="entityType" class="form-control" onchange="masterDataPage.handleEntityTypeChange()" required>
                            <option value="">请选择</option>
                            <option value="PERSON">人员</option>
                            <option value="SUPPLIER">供应商</option>
                            <option value="ORGANIZATION">组织</option>
                        </select>
                    </div>
                    <div id="dynamicFields"></div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="masterDataPage.closeCreateModal()">取消</button>
                <button class="btn btn-primary" onclick="masterDataPage.submitForm()">保存</button>
            </div>
        </div>
    </div>

    <script src="js/common.js"></script>
    <script src="js/components.js"></script>
    <script src="js/master-data-service.js"></script>
    <script src="js/master-data-management.js"></script>
    
    <script>
        // 拦截console.log以显示在页面上
        const testLog = document.getElementById('testLog');
        const originalLog = console.log;
        const originalError = console.error;
        
        function addLog(message, type = 'log') {
            const div = document.createElement('div');
            div.style.color = type === 'error' ? '#ef4444' : type === 'success' ? '#10b981' : '#e2e8f0';
            div.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            testLog.appendChild(div);
            testLog.scrollTop = testLog.scrollHeight;
        }
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            addLog(args.join(' '), 'log');
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            addLog(args.join(' '), 'error');
        };
        
        // 监听按钮点击
        document.addEventListener('DOMContentLoaded', function() {
            addLog('DOM加载完成', 'success');
            
            const createBtn = document.getElementById('createBtn');
            if (createBtn) {
                addLog('找到新增按钮元素', 'success');
                
                // 添加额外的测试监听器
                createBtn.addEventListener('click', function() {
                    addLog('按钮点击事件触发！', 'success');
                }, true);
            } else {
                addLog('未找到新增按钮元素', 'error');
            }
        });
    </script>
</body>
</html>
