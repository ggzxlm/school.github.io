# 基建采购监督模块完善说明

## 概述

本次更新完善了纪检监督中的基建采购监督模块，确保详情页面内容与列表内容完全关联一致。该模块包含三个子功能：项目监督检查点、投标人关联分析、排他性条款识别。

## 数据结构设计

### 1. 项目监督检查点数据（5条记录）

```javascript
{
    project: '项目名称',
    projectNo: '项目编号',  // 用作唯一标识
    amount: 项目金额,
    buildingUnit: '建设单位',
    contractor: '施工单位',
    checkpoint: '检查点名称',
    content: '检查内容',
    result: '检查结果',
    risk: '风险等级',
    checkDate: '检查日期',
    checker: '检查人员',
    issues: ['问题清单'],
    suggestions: '整改建议'
}
```

**详情页面展示：**
- 项目基本信息：项目名称、编号、金额、建设单位、施工单位
- 检查情况：检查点、检查内容、检查日期、检查人员、检查结果、风险等级
- 问题与建议：如有问题显示红色警告框，否则显示绿色合规评价

### 2. 投标人关联分析数据（4条记录）

```javascript
{
    project: '项目名称',
    projectNo: '项目编号',
    companyA: '企业A名称',
    companyACode: '企业A统一社会信用代码',
    companyALegal: '企业A法定代表人',
    companyB: '企业B名称',
    companyBCode: '企业B统一社会信用代码',
    companyBLegal: '企业B法定代表人',
    relationType: '关联类型',
    detail: '关联详情',
    risk: '风险等级',
    evidence: ['关联证据'],
    bidAmount: {
        companyA: 企业A投标金额,
        companyB: 企业B投标金额
    }
}
```

**详情页面展示：**
- 项目信息：项目名称、编号
- 企业A信息：企业名称、统一社会信用代码、法定代表人、投标金额
- 企业B信息：企业名称、统一社会信用代码、法定代表人、投标金额
- 关联分析：关联类型、关联详情、风险等级
- 关联证据：显示红色警告框列出所有证据和风险提示

### 3. 排他性条款识别数据（5条记录）

```javascript
{
    project: '项目名称',
    projectNo: '项目编号',
    document: '文件名称',
    documentDate: '文件日期',
    clause: '条款内容',
    clauseLocation: '条款位置',
    type: '条款类型',
    risk: '风险等级',
    analysis: '问题分析',
    legalBasis: '法律依据',
    impact: '影响分析',
    suggestion: '整改建议'
}
```

**详情页面展示：**
- 项目信息：项目名称、编号
- 文件信息：文件名称、发布日期、条款位置
- 条款内容：条款内容、条款类型、风险等级
- 分析与建议：显示红色警告框，包含问题描述、法律依据、影响分析、整改建议

## 典型案例

### 案例1：项目监督检查点 - 新校区图书馆建设

**基本信息：**
- 项目金额：8500万元
- 检查点：招标文件审查
- 检查结果：发现3处倾向性条款

**发现的问题：**
1. 要求投标人必须具有某品牌产品授权
2. 指定特定型号的材料设备
3. 要求投标人具有本地区类似项目经验

**整改建议：**
要求建设单位修改招标文件，删除倾向性条款，确保公平竞争

### 案例2：投标人关联分析 - 新校区图书馆建设

**关联类型：**法人关联

**关联详情：**两家企业法人为夫妻关系

**关联证据：**
1. 张某某与李某某为夫妻关系（民政局婚姻登记信息）
2. 两家企业注册地址相近，仅相隔200米
3. 两家企业财务人员为同一人
4. 两家企业银行账户存在频繁资金往来

**风险提示：**
两家企业存在关联关系，可能涉嫌围标串标，建议取消其投标资格或要求其中一家退出投标

### 案例3：排他性条款识别 - 实验楼装修工程

**条款内容：**要求投标人具有本地区类似项目经验

**条款类型：**地域限制

**问题分析：**
限定本地区经验构成地域歧视，排除了外地优秀企业，违反了公平竞争原则

**法律依据：**
《招标投标法》第十八条：招标人不得以不合理的条件限制或者排斥潜在投标人

**影响分析：**
严重限制竞争，可能导致本地企业形成垄断，影响工程质量和造价

**整改建议：**
删除地域限制，改为要求类似项目经验，不限定地区

## 数据关联一致性

### 查找机制

所有详情函数都通过项目编号（projectNo）从数据数组中查找对应记录：

```javascript
// 项目监督检查点
const checkpoint = projectCheckpointData.find(c => c.projectNo === projectNo);

// 投标人关联分析
const relation = bidderRelationData.find(r => r.projectNo === projectNo);

// 排他性条款识别
const clause = exclusiveClauseData.find(c => c.projectNo === projectNo);
```

### 列表与详情对应关系

| 功能模块 | 列表字段 | 详情页面对应内容 |
|---------|---------|----------------|
| 项目检查点 | 项目名称 | 项目基本信息 - 项目名称 |
| 项目检查点 | 项目金额 | 项目基本信息 - 项目金额 |
| 项目检查点 | 检查点 | 检查情况 - 检查点 |
| 项目检查点 | 检查内容 | 检查情况 - 检查内容 |
| 项目检查点 | 检查结果 | 检查情况 - 检查结果 |
| 项目检查点 | 风险等级 | 检查情况 - 风险等级 |
| 投标人关联 | 项目名称 | 项目信息 - 项目名称 |
| 投标人关联 | 企业A | 企业A信息 - 企业名称 |
| 投标人关联 | 企业B | 企业B信息 - 企业名称 |
| 投标人关联 | 关联类型 | 关联分析 - 关联类型 |
| 投标人关联 | 关联详情 | 关联分析 - 关联详情 |
| 投标人关联 | 风险等级 | 关联分析 - 风险等级 |
| 排他性条款 | 项目名称 | 项目信息 - 项目名称 |
| 排他性条款 | 文件名称 | 文件信息 - 文件名称 |
| 排他性条款 | 条款内容 | 条款内容 - 条款内容 |
| 排他性条款 | 条款类型 | 条款内容 - 条款类型 |
| 排他性条款 | 风险等级 | 条款内容 - 风险等级 |

## 文件说明

### 已创建的文件

1. **construction_supervision_update.js** - 包含完整的数据结构和详情函数
2. **CONSTRUCTION_SUPERVISION_ENHANCEMENT.md** - 本说明文档

### 需要集成的内容

将 `construction_supervision_update.js` 中的以下内容集成到 `js/discipline-supervision.js`：

1. **数据数组**（在基建采购模块开始处添加）：
   - `exclusiveClauseData` - 排他性条款数据

2. **加载函数**（替换现有函数）：
   - `loadExclusiveClauseDetection()` - 加载排他性条款

3. **详情函数**（替换现有函数）：
   - `viewCheckpointDetail(projectNo)` - 查看检查点详情
   - `viewRelationGraph(projectNo)` - 查看关系图谱
   - `viewClauseDetail(projectNo)` - 查看条款详情

## 使用说明

### 在纪检监督页面中使用

1. 访问 `discipline-supervision.html?type=construction`
2. 页面会自动加载基建采购监督模块
3. 查看三个子功能的列表数据
4. 点击"查看"或"图谱"按钮查看详情

### 数据扩展

如需添加更多数据，在对应的数据数组中添加新对象，确保包含所有必需字段。

## 技术特点

1. **数据驱动** - 所有显示内容基于数据生成
2. **完全关联** - 列表和详情基于同一数据源
3. **唯一标识** - 使用项目编号作为唯一标识符
4. **详细证据** - 投标人关联分析包含详细的关联证据
5. **法律依据** - 排他性条款识别包含法律依据和整改建议
6. **视觉反馈** - 使用颜色和图标清晰展示风险等级

## 风险等级说明

### 项目监督检查点风险等级

- **高风险**：发现严重违规问题，如倾向性条款、围标串标等
- **中风险**：发现一般性问题，如程序不规范、变更频繁等
- **低风险**：未发现问题或问题轻微

### 投标人关联风险等级

- **高风险**：法人关联、股权关联等直接关联关系
- **中风险**：人员关联、地址关联等间接关联关系
- **低风险**：无明显关联关系

### 排他性条款风险等级

- **高风险**：品牌限制、地域限制、型号指定等严重排他性条款
- **中风险**：资金门槛过高、资质限制等一般性排他性条款
- **低风险**：合理的资格要求

## 注意事项

1. 确保 `formatNumber` 函数可用（用于格式化金额）
2. 确保 `showDetailModal` 函数可用（用于显示详情弹窗）
3. 确保 `Toast` 组件可用（用于显示提示信息）
4. 项目编号（projectNo）必须唯一
5. 风险等级必须是 `high`、`medium` 或 `low`

## 总结

本次更新为基建采购监督模块创建了完整的数据结构和详情展示功能，确保了列表和详情页面的数据完全一致。通过详细的问题分析、法律依据和整改建议，为基建采购监督工作提供了有力的技术支持。

所有详情页面都与列表数据完全关联，包括项目信息、检查结果、关联证据、条款分析等所有字段，确保了数据的一致性和准确性。
