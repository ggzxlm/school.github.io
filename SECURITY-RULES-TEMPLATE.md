# 数据安全策略 - 执行规则模板

## 功能说明

执行规则字段已优化为**可选择的模板方式**，根据不同的策略类型提供预设的规则模板，用户可以：
1. 选择预设模板（推荐）
2. 自定义规则
3. 不填写规则（可选）

## 使用方法

### 1. 选择策略类型
首先选择策略类型，系统会自动加载对应的规则模板。

### 2. 选择规则模板
在"执行规则"下拉框中选择：
- **预设模板**：根据策略类型显示的专业模板
- **自定义规则**：手动输入自定义规则
- **不选择**：留空，后续可补充

### 3. 预览规则
选择模板后，会在下方显示规则预览，确认无误后保存。

## 规则模板列表

### 访问控制类型

#### 1. 身份认证要求
```
1. 用户必须通过身份认证
2. 使用强密码策略
3. 启用多因素认证（MFA）
```

#### 2. 访问审批流程
```
1. 访问需要部门主管审批
2. 敏感数据访问需要二级审批
3. 记录所有审批流程
```

#### 3. IP白名单控制
```
1. 仅允许白名单IP访问
2. 定期更新IP白名单
3. 记录所有访问来源
```

#### 4. 时间限制访问
```
1. 仅工作时间允许访问
2. 非工作时间需要特殊授权
3. 记录非工作时间访问
```

#### 5. 基于角色的访问
```
1. 按角色分配访问权限
2. 最小权限原则
3. 定期审查角色权限
```

### 数据脱敏类型

#### 1. 身份证号脱敏
```
1. 保留前6位和后4位
2. 中间位数用*替代
3. 格式：110101********1234
```

#### 2. 手机号脱敏
```
1. 保留前3位和后4位
2. 中间4位用*替代
3. 格式：138****5678
```

#### 3. 姓名脱敏
```
1. 保留姓氏
2. 名字用*替代
3. 格式：张**
```

#### 4. 邮箱脱敏
```
1. 保留@前2位和域名
2. 其余用*替代
3. 格式：zh***@example.com
```

#### 5. 银行卡号脱敏
```
1. 仅保留后4位
2. 其余用*替代
3. 格式：**** **** **** 1234
```

### 数据加密类型

#### 1. 存储加密
```
1. 使用AES-256加密算法
2. 密钥定期轮换
3. 密钥安全存储
```

#### 2. 传输加密
```
1. 使用TLS 1.3协议
2. 强制HTTPS传输
3. 禁用弱加密算法
```

#### 3. 字段级加密
```
1. 敏感字段单独加密
2. 使用不同密钥
3. 支持密文检索
```

#### 4. 备份加密
```
1. 备份文件加密存储
2. 异地备份加密传输
3. 加密密钥分离管理
```

### 审计监控类型

#### 1. 访问日志记录
```
1. 记录所有数据访问
2. 包含用户、时间、操作
3. 日志保留180天
```

#### 2. 变更日志记录
```
1. 记录所有数据变更
2. 包含变更前后值
3. 支持变更回溯
```

#### 3. 导出操作审计
```
1. 记录所有数据导出
2. 需要审批才能导出
3. 导出文件加密
```

#### 4. 异常行为告警
```
1. 监控异常访问模式
2. 实时告警通知
3. 自动阻断可疑操作
```

### 数据备份类型

#### 1. 每日备份
```
1. 每日凌晨自动备份
2. 保留最近30天备份
3. 验证备份完整性
```

#### 2. 增量备份
```
1. 每小时增量备份
2. 每周全量备份
3. 优化存储空间
```

#### 3. 异地备份
```
1. 备份到异地机房
2. 加密传输和存储
3. 定期恢复演练
```

#### 4. 版本备份
```
1. 保留多个历史版本
2. 支持任意时间点恢复
3. 版本标记和说明
```

### 权限管理类型

#### 1. 角色权限管理
```
1. 基于角色分配权限
2. 支持权限继承
3. 定期权限审查
```

#### 2. 临时权限授予
```
1. 支持临时权限申请
2. 设置权限有效期
3. 到期自动回收
```

#### 3. 权限审批流程
```
1. 权限申请需要审批
2. 多级审批机制
3. 审批记录可追溯
```

#### 4. 职责分离
```
1. 关键操作职责分离
2. 防止权限滥用
3. 互相监督制约
```

## 使用场景

### 场景1：快速创建标准策略
```
1. 选择策略类型：访问控制
2. 选择规则模板：身份认证要求
3. 系统自动填充专业规则
4. 保存即可
```

### 场景2：自定义特殊规则
```
1. 选择策略类型：数据加密
2. 选择：自定义规则
3. 手动输入特定规则
4. 保存
```

### 场景3：先创建后补充
```
1. 创建策略时不选择规则
2. 后续编辑时再选择模板
3. 灵活调整
```

## 优势

### 1. 专业性 ✅
- 预设规则由安全专家编写
- 符合行业最佳实践
- 覆盖常见安全场景

### 2. 便捷性 ✅
- 一键选择，无需手写
- 减少输入错误
- 提高创建效率

### 3. 灵活性 ✅
- 支持选择模板
- 支持自定义规则
- 支持不填写

### 4. 可扩展性 ✅
- 易于添加新模板
- 支持多种策略类型
- 模板可持续优化

## 技术实现

### 动态模板加载
```javascript
// 根据策略类型动态加载对应模板
handlePolicyTypeChange() {
    const policyType = document.getElementById('policyType').value;
    const templates = this.getRuleTemplates(policyType);
    // 更新下拉选项
}
```

### 规则预览
```javascript
// 选择模板后显示规则预览
handleRuleTemplateChange() {
    const rules = selectedOption.dataset.rules;
    previewContent.textContent = rules;
}
```

### 自定义支持
```javascript
// 支持自定义规则输入
if (selectedValue === 'custom') {
    customGroup.style.display = 'block';
}
```

## 后续优化

### 短期
- [ ] 添加更多规则模板
- [ ] 支持模板收藏
- [ ] 规则模板搜索

### 中期
- [ ] 规则模板分类管理
- [ ] 支持导入导出模板
- [ ] 模板使用统计

### 长期
- [ ] AI智能推荐规则
- [ ] 规则有效性验证
- [ ] 规则执行效果分析

---

**版本**: 1.0.0  
**更新时间**: 2024-10-25  
**状态**: ✅ 已完成
