# æ‹›æ ‡æ–‡ä»¶åˆ†æ undefined é—®é¢˜ä¿®å¤

## ğŸ› é—®é¢˜æè¿°

åœ¨æ™ºèƒ½åˆ†æé¡µé¢çš„æ‹›æ ‡æ–‡ä»¶åˆ†æåŠŸèƒ½ä¸­ï¼Œæ˜¾ç¤ºç»“æœæ—¶å‡ºç° `undefined` é”™è¯¯ã€‚

**é”™è¯¯ä½ç½®**ï¼š
- ç¬¬12è¡Œ: undefined
- ç¬¬13è¡Œ: undefined

## ğŸ” é—®é¢˜åŸå› 

### æ ¹æœ¬åŸå› 
åœ¨ `renderTenderResult` å‡½æ•°ä¸­ï¼Œä»£ç å°è¯•è®¿é—® `risk.details` æ•°ç»„ä¸­çš„ `line` å’Œ `content` å±æ€§ï¼Œä½†æ•°æ®ç»“æ„ä¸åŒ¹é…å¯¼è‡´æ˜¾ç¤º `undefined`ã€‚

### æ•°æ®æµç¨‹
```
1. analyzeTenderDocument() 
   â†’ è°ƒç”¨ detectSensitiveWords()
   â†’ è¿”å›æ•æ„Ÿè¯æ•°ç»„

2. assessTenderRisks()
   â†’ å°† sensitiveWords ç›´æ¥ä½œä¸º details
   â†’ ä½† sensitiveWords çš„ç»“æ„ä¸é¢„æœŸä¸åŒ

3. renderTenderResult()
   â†’ å°è¯•è®¿é—® detail.line å’Œ detail.content
   â†’ å®é™…æ•°æ®ä¸­æ²¡æœ‰ content å±æ€§ï¼ˆåªæœ‰ contextï¼‰
   â†’ æ˜¾ç¤º undefined
```

### æ•°æ®ç»“æ„å¯¹æ¯”

**sensitiveWords çš„å®é™…ç»“æ„**ï¼š
```javascript
{
    word: 'æŒ‡å®š',
    category: 'discrimination',
    position: 123,
    context: '...ä¸Šä¸‹æ–‡...',  // æ³¨æ„æ˜¯ context
    line: 5
}
```

**ä»£ç æœŸæœ›çš„ç»“æ„**ï¼š
```javascript
{
    line: 5,
    content: 'å®Œæ•´å†…å®¹',  // æœŸæœ›æ˜¯ content
    keyword: 'æŒ‡å®š',
    type: 'exclusive'
}
```

## âœ… ä¿®å¤æ–¹æ¡ˆ

### ä¿®å¤1ï¼šæ›´æ–° text-analysis-service.js

åœ¨ `assessTenderRisks` å‡½æ•°ä¸­ï¼Œè½¬æ¢æ•æ„Ÿè¯æ ¼å¼ï¼š

```javascript
// ä¿®å¤å‰
if (sensitiveWords.length > 0) {
    risks.push({
        type: 'sensitive_words',
        level: 'high',
        description: `å‘ç°${sensitiveWords.length}ä¸ªæ•æ„Ÿè¯`,
        details: sensitiveWords  // ç›´æ¥ä½¿ç”¨ï¼Œç»“æ„ä¸åŒ¹é…
    });
}

// ä¿®å¤å
if (sensitiveWords.length > 0) {
    // è½¬æ¢æ•æ„Ÿè¯æ ¼å¼ä»¥åŒ¹é…æ˜¾ç¤ºéœ€æ±‚
    const formattedDetails = sensitiveWords.map(sw => ({
        line: sw.line,
        content: sw.context,  // å°† context æ˜ å°„ä¸º content
        keyword: sw.word,
        type: 'sensitive'
    }));
    
    risks.push({
        type: 'sensitive_words',
        level: 'high',
        description: `å‘ç°${sensitiveWords.length}ä¸ªæ•æ„Ÿè¯`,
        details: formattedDetails  // ä½¿ç”¨è½¬æ¢åçš„æ ¼å¼
    });
}
```

### ä¿®å¤2ï¼šæ›´æ–° intelligent-analysis.js

å¢å¼º `renderTenderResult` å‡½æ•°çš„å®¹é”™æ€§ï¼š

```javascript
// ä¿®å¤å‰
<strong>ç¬¬${detail.line}è¡Œ:</strong> ${detail.content}

// ä¿®å¤å
<strong>ç¬¬${detail.line || '?'}è¡Œ:</strong> ${detail.content || detail}
```

**æ”¹è¿›ç‚¹**ï¼š
1. æ·»åŠ  `detail.line || '?'` é˜²æ­¢ line ä¸º undefined
2. æ·»åŠ  `detail.content || detail` ä½œä¸ºåå¤‡å€¼
3. æ·»åŠ  `Array.isArray(risk.details)` æ£€æŸ¥
4. æ·»åŠ  `risk.description || 'é£é™©é¡¹'` é»˜è®¤å€¼

## ğŸ“ ä¿®å¤çš„æ–‡ä»¶

| æ–‡ä»¶ | ä¿®æ”¹å†…å®¹ |
|------|----------|
| `js/text-analysis-service.js` | ä¿®å¤ assessTenderRisks å‡½æ•°ï¼Œè½¬æ¢æ•°æ®æ ¼å¼ |
| `js/intelligent-analysis.js` | å¢å¼º renderTenderResult å‡½æ•°çš„å®¹é”™æ€§ |

## ğŸ§ª æµ‹è¯•éªŒè¯

### æµ‹è¯•æ­¥éª¤

1. **æ‰“å¼€æ™ºèƒ½åˆ†æé¡µé¢**
   ```
   intelligent-analysis.html
   ```

2. **é€‰æ‹©æ‹›æ ‡æ–‡ä»¶åˆ†æ**
   - ç‚¹å‡»"æ‹›æ ‡æ–‡ä»¶åˆ†æ"æŒ‰é’®

3. **åŠ è½½ç¤ºä¾‹æ–‡æœ¬**
   - ç‚¹å‡»"æ‹›æ ‡æ–‡ä»¶ç¤ºä¾‹"æŒ‰é’®
   - æˆ–æ‰‹åŠ¨è¾“å…¥æ‹›æ ‡æ–‡ä»¶å†…å®¹

4. **å¼€å§‹åˆ†æ**
   - ç‚¹å‡»"å¼€å§‹åˆ†æ"æŒ‰é’®
   - ç­‰å¾…åˆ†æå®Œæˆ

5. **æŸ¥çœ‹ç»“æœ**
   - æ£€æŸ¥"é£é™©æ£€æµ‹"éƒ¨åˆ†
   - ç¡®è®¤ä¸å†æ˜¾ç¤º undefined
   - ç¡®è®¤æ˜¾ç¤ºæ­£ç¡®çš„è¡Œå·å’Œå†…å®¹

### é¢„æœŸç»“æœ

**ä¿®å¤å‰**ï¼š
```
ç¬¬12è¡Œ: undefined
ç¬¬13è¡Œ: undefined
```

**ä¿®å¤å**ï¼š
```
ç¬¬5è¡Œ: ...æ ¸å¿ƒäº¤æ¢æœºï¼šäº¤æ¢å®¹é‡ä¸ä½äº10Tbpsï¼Œå¿…é¡»ä¸ºåä¸ºå“ç‰Œ...
ç¬¬6è¡Œ: ...æ±‡èšäº¤æ¢æœºï¼šç«¯å£æ•°é‡ä¸å°‘äº48ä¸ªï¼ŒæŒ‡å®šæ€ç§‘å“ç‰Œ...
```

## ğŸ“Š æµ‹è¯•ç”¨ä¾‹

### æµ‹è¯•ç”¨ä¾‹1ï¼šæ’ä»–æ€§æ¡æ¬¾æ£€æµ‹

**è¾“å…¥**ï¼š
```
æŠ€æœ¯è¦æ±‚ï¼š
1. æ ¸å¿ƒäº¤æ¢æœºï¼šå¿…é¡»ä¸ºåä¸ºå“ç‰Œ
2. æ±‡èšäº¤æ¢æœºï¼šæŒ‡å®šæ€ç§‘å“ç‰Œ
```

**é¢„æœŸè¾“å‡º**ï¼š
- å‘ç°2å¤„æ’ä»–æ€§æ¡æ¬¾
- ç¬¬1è¡Œæ˜¾ç¤ºå®Œæ•´å†…å®¹
- ç¬¬2è¡Œæ˜¾ç¤ºå®Œæ•´å†…å®¹
- æ—  undefined é”™è¯¯

### æµ‹è¯•ç”¨ä¾‹2ï¼šæ•æ„Ÿè¯æ£€æµ‹

**è¾“å…¥**ï¼š
```
é¡¹ç›®è¦æ±‚ï¼š
1. ä¾›åº”å•†å¿…é¡»ä¸é‡‡è´­äººæœ‰è‰¯å¥½å…³ç³»
2. ä¼˜å…ˆè€ƒè™‘æœ¬åœ°ä¼ä¸š
```

**é¢„æœŸè¾“å‡º**ï¼š
- å‘ç°æ•æ„Ÿè¯
- æ˜¾ç¤ºè¡Œå·å’Œä¸Šä¸‹æ–‡
- æ—  undefined é”™è¯¯

### æµ‹è¯•ç”¨ä¾‹3ï¼šç»¼åˆæ£€æµ‹

**è¾“å…¥**ï¼š
```
æ‹›æ ‡å…¬å‘Š
é¡¹ç›®åç§°ï¼šæ ¡å›­ç½‘ç»œè®¾å¤‡é‡‡è´­é¡¹ç›®
æŠ€æœ¯è¦æ±‚ï¼š
1. æ ¸å¿ƒäº¤æ¢æœºï¼šå¿…é¡»ä¸ºåä¸ºå“ç‰Œ
2. æ±‡èšäº¤æ¢æœºï¼šæŒ‡å®šæ€ç§‘å“ç‰Œ
3. æ¥å…¥äº¤æ¢æœºï¼šå”¯ä¸€æ”¯æŒH3Cå“ç‰Œ
```

**é¢„æœŸè¾“å‡º**ï¼š
- å‘ç°3å¤„æ’ä»–æ€§æ¡æ¬¾
- å‘ç°å¤šä¸ªæ•æ„Ÿè¯
- æ‰€æœ‰å†…å®¹æ­£ç¡®æ˜¾ç¤º
- æ—  undefined é”™è¯¯

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### æ•°æ®è½¬æ¢é€»è¾‘

```javascript
// æ•æ„Ÿè¯åŸå§‹æ ¼å¼
const sensitiveWord = {
    word: 'æŒ‡å®š',
    category: 'discrimination',
    position: 123,
    context: '...æ±‡èšäº¤æ¢æœºï¼šç«¯å£æ•°é‡ä¸å°‘äº48ä¸ªï¼ŒæŒ‡å®šæ€ç§‘å“ç‰Œ...',
    line: 6
};

// è½¬æ¢ä¸ºæ˜¾ç¤ºæ ¼å¼
const formattedDetail = {
    line: 6,
    content: '...æ±‡èšäº¤æ¢æœºï¼šç«¯å£æ•°é‡ä¸å°‘äº48ä¸ªï¼ŒæŒ‡å®šæ€ç§‘å“ç‰Œ...',
    keyword: 'æŒ‡å®š',
    type: 'sensitive'
};
```

### å®¹é”™å¤„ç†

```javascript
// 1. æ£€æŸ¥ details æ˜¯å¦å­˜åœ¨ä¸”ä¸ºæ•°ç»„
risk.details && Array.isArray(risk.details) && risk.details.length > 0

// 2. æä¾›é»˜è®¤å€¼
detail.line || '?'
detail.content || detail

// 3. æä¾›æè¿°é»˜è®¤å€¼
risk.description || 'é£é™©é¡¹'
```

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. æ•°æ®ç»“æ„ä¸€è‡´æ€§
- ç¡®ä¿æ•°æ®ç”Ÿæˆå’Œä½¿ç”¨çš„ç»“æ„ä¸€è‡´
- ä½¿ç”¨æ˜ç¡®çš„æ¥å£å®šä¹‰
- æ·»åŠ æ•°æ®è½¬æ¢å±‚

### 2. å®¹é”™å¤„ç†
- æ£€æŸ¥æ•°æ®æ˜¯å¦å­˜åœ¨
- æä¾›é»˜è®¤å€¼
- ä½¿ç”¨å¯é€‰é“¾æ“ä½œç¬¦

### 3. è°ƒè¯•æŠ€å·§
- ä½¿ç”¨ console.log æŸ¥çœ‹æ•°æ®ç»“æ„
- æ£€æŸ¥æ•°æ®æµè½¬è·¯å¾„
- éªŒè¯æ¯ä¸ªç¯èŠ‚çš„è¾“å‡º

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·æä¾›ï¼š
1. æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯ä¿¡æ¯
2. è¾“å…¥çš„æ–‡æœ¬å†…å®¹
3. åˆ†æç»“æœæˆªå›¾

è”ç³»æ–¹å¼ï¼š
- æŠ€æœ¯æ”¯æŒï¼šçºªæ£€ç›‘å¯Ÿå®¤
- ç³»ç»Ÿç®¡ç†å‘˜ï¼šä¿¡æ¯ä¸­å¿ƒ

## ğŸ“ æ›´æ–°è®°å½•

| æ—¥æœŸ | ç‰ˆæœ¬ | æ›´æ–°å†…å®¹ | æ›´æ–°äºº |
|------|------|----------|--------|
| 2025-10-29 | v1.0 | ä¿®å¤æ‹›æ ‡æ–‡ä»¶åˆ†æ undefined é—®é¢˜ | Kiro |

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**åˆ›å»ºæ—¶é—´**: 2025-10-29  
**çŠ¶æ€**: âœ… å·²ä¿®å¤

**Â© 2025 é«˜æ ¡çºªæ£€å®¡è®¡ç›‘ç®¡ä¸€ä½“åŒ–å¹³å° | å¹¿ä¸œç»¿åŠ›ç½‘æ ¼ç§‘æŠ€æœ‰é™å…¬å¸**
