# Dashboard待办数据更新完成

## 更新时间
2025-10-28

## 问题描述
待办详情页面只显示标题和简单描述，缺少完整的业务信息：
- 没有来源追溯
- 没有任务详情
- 没有证据材料
- 没有附件列表
- 没有操作清单
- 没有操作记录

## 根本原因
dashboard.js中的待办数据只包含基本字段（id、title、type、deadline、priority、status），缺少完整的业务数据结构。

## 解决方案

### 1. 更新待办数据结构
为所有8个待办任务添加了完整的数据字段：

```javascript
{
    id: 1,
    title: '任务标题',
    description: '详细描述',
    type: '任务类型',
    deadline: '截止时间',
    priority: 'urgent|high|normal',
    status: 'pending',
    
    // 新增：来源追溯
    source: {
        type: 'alert|clue|workorder|rectification',
        id: '来源ID',
        title: '来源标题',
        module: '所属模块',
        createdAt: '创建时间'
    },
    
    // 新增：关联关系
    relations: {
        clueId: '线索ID',
        clueTitle: '线索标题',
        workOrderId: '工单ID',
        rectificationId: '整改ID'
    },
    
    // 新增：任务详情
    details: {
        unit: '涉及单位',
        person: '涉及人员',
        amount: 金额,
        riskLevel: 'high|medium|low',
        evidence: ['证据1', '证据2'],
        attachments: [
            { name: '文件名', size: '文件大小' }
        ]
    },
    
    // 新增：处理流程
    process: {
        expectedDuration: 预计天数,
        requiredActions: [
            { action: '操作名称', completed: true|false }
        ],
        notes: '注意事项'
    },
    
    // 新增：操作记录
    history: [
        {
            time: '时间',
            user: '用户',
            action: '操作',
            note: '说明'
        }
    ]
}
```

### 2. 更新的待办任务

#### 任务1：审核科研经费报销单 - 张教授课题组
- **类型**：预警核查
- **优先级**：紧急
- **来源**：预警ALERT2025001
- **涉及金额**：8.5万元
- **风险等级**：高风险
- **证据**：连号发票5张
- **附件**：2个
- **操作步骤**：4项
- **历史记录**：2条

#### 任务2：复查基建项目整改材料 - 图书馆改造工程
- **类型**：整改复查
- **优先级**：重要
- **来源**：整改ZG2025004
- **风险等级**：中风险
- **证据**：4项
- **附件**：3个
- **操作步骤**：4项
- **历史记录**：3条

#### 任务3：处理招生录取异常预警 - 计算机学院
- **类型**：预警处置
- **优先级**：紧急
- **来源**：预警ALERT2025003
- **风险等级**：高风险
- **证据**：3项
- **附件**：1个
- **操作步骤**：3项
- **历史记录**：1条

#### 任务4：审批工单分配申请 - 三公经费超标核查
- **类型**：工单审批
- **优先级**：普通
- **来源**：工单WO202510210003
- **风险等级**：中风险
- **证据**：2项
- **操作步骤**：3项
- **历史记录**：1条

#### 任务5：完成月度监督报告编写
- **类型**：报告编写
- **优先级**：重要
- **风险等级**：低风险
- **操作步骤**：4项（1项已完成）
- **历史记录**：2条

#### 任务6：参加纪检工作协调会
- **类型**：会议参加
- **优先级**：普通
- **风险等级**：低风险
- **历史记录**：1条

#### 任务7：审核供应商关联冲突预警
- **类型**：预警核查
- **优先级**：普通
- **来源**：预警ALERT2025005
- **风险等级**：中风险
- **证据**：2项
- **操作步骤**：3项
- **历史记录**：1条

#### 任务8：跟进学术不端行为调查
- **类型**：线索跟进
- **优先级**：重要
- **来源**：线索CLUE2025007
- **风险等级**：高风险
- **证据**：4项
- **附件**：2个
- **操作步骤**：5项（3项已完成）
- **历史记录**：3条

### 3. 更新文件版本
- `dashboard.html` - 更新版本号为 `?v=3.0`
- `js/dashboard.js` - 数据已更新
- `css/dashboard.css` - 更新版本号为 `?v=3.0`

## 使用方法

### 1. 强制刷新浏览器
**必须执行此步骤！**

- **Windows/Linux**: 按 `Ctrl + Shift + R` 或 `Ctrl + F5`
- **Mac**: 按 `Cmd + Shift + R`

### 2. 打开Dashboard页面
访问 `dashboard.html` 页面

### 3. 查看待办详情
点击任意待办任务的"查看"按钮

### 4. 验证完整信息
应该能看到以下所有内容：
- ✅ 标题和描述
- ✅ 优先级标签
- ✅ 注意事项（如果有）
- ✅ 来源追溯（带跳转按钮）
- ✅ 任务详情（单位、人员、金额、风险等级）
- ✅ 证据材料列表
- ✅ 附件列表（带下载按钮）
- ✅ 需要的操作（复选框列表）
- ✅ 操作记录（时间轴）

## 数据特点

### 完整性
- 所有8个待办任务都包含完整的业务数据
- 不同类型的任务有不同的数据侧重点

### 真实性
- 数据模拟真实的业务场景
- 包含具体的金额、日期、人员等信息

### 关联性
- 部分任务有来源追溯（预警、线索、工单、整改）
- 支持跳转到相关页面查看详情

### 可追溯性
- 每个任务都有操作历史记录
- 时间轴展示任务的完整生命周期

## 技术说明

### 数据位置
`js/dashboard.js` 文件中的 `mockData.todos` 数组

### 数据大小
- 更新前：每个待办约6个字段
- 更新后：每个待办约10-15个字段
- 数据量增加约3-5倍

### 兼容性
- 向后兼容：旧字段保持不变
- 向前扩展：新增字段为可选
- 不影响现有功能

## 验证清单

- [ ] 强制刷新浏览器（Ctrl+Shift+R）
- [ ] 打开dashboard.html页面
- [ ] 点击第1个待办的"查看"按钮
- [ ] 验证能看到"来源追溯"部分
- [ ] 验证能看到"任务详情"部分
- [ ] 验证能看到"证据材料"列表
- [ ] 验证能看到"附件列表"
- [ ] 验证能看到"需要的操作"清单
- [ ] 验证能看到"操作记录"时间轴
- [ ] 点击"来源追溯"的"查看"按钮测试跳转
- [ ] 测试其他待办任务的详情

## 常见问题

**Q: 为什么还是看不到新增的内容？**
A: 必须强制刷新浏览器（Ctrl+Shift+R），清除缓存。

**Q: 某些待办没有来源追溯？**
A: 正常现象。只有来自预警、线索、工单、整改的任务才有来源追溯。

**Q: 某些待办没有证据材料？**
A: 正常现象。不是所有任务都需要证据材料（如会议、报告编写等）。

**Q: 操作清单的复选框不能点击？**
A: 这是只读展示，实际操作需要在处理页面进行。

**Q: 附件下载不工作？**
A: 这是演示功能，实际下载需要后端API支持。

## 后续工作

1. 根据实际业务需求调整数据结构
2. 对接后端API获取真实数据
3. 实现附件的实际下载功能
4. 添加数据的增删改功能
5. 优化数据加载性能

## 相关文档

- `DASHBOARD-TODO-DETAIL-FIX.md` - 详情页面功能修复说明
- `MY-TASKS-COMPLETE.md` - 我的待办页面完善说明
- `CLEAR-CACHE-GUIDE.md` - 清除缓存指南

## 更新记录

- 2025-10-28 15:00 - 更新所有待办数据，添加完整业务字段
- 2025-10-28 14:30 - 更新viewTodoDetail函数，支持显示完整信息
- 2025-10-28 14:00 - 添加viewSourceDetail函数，支持来源跳转
