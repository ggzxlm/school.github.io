<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>主数据管理 - 高校纪检审计监管一体化平台</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="stylesheet" href="css/common.css">
    <link rel="stylesheet" href="css/master-data-management.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="app-container">
        <!-- 顶部导航栏 -->
        <header id="top-navbar"></header>

        <div class="main-wrapper">
            <!-- 侧边导航栏 -->
            <aside id="side-navbar"></aside>

            <!-- 主内容区 -->
            <main class="content-area">
                <!-- 页面标题 -->
                <div class="page-header-section">
                    <h1 class="page-title">主数据管理</h1>
                    <p class="page-description">统一管理人员、组织、供应商等主数据，消除数据孤岛和重复数据</p>
                </div>

                <!-- 主数据统计卡片 -->
                <div class="stats-grid">
                    <div class="stat-card stat-card-primary">
                        <div class="stat-icon">
                            <i class="fas fa-database"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-label">全部主数据</div>
                            <div class="stat-value" id="allCount">0</div>
                        </div>
                    </div>

                    <div class="stat-card stat-card-success">
                        <div class="stat-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-label">人员</div>
                            <div class="stat-value" id="personCount">0</div>
                        </div>
                    </div>

                    <div class="stat-card stat-card-info">
                        <div class="stat-icon">
                            <i class="fas fa-building"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-label">供应商</div>
                            <div class="stat-value" id="supplierCount">0</div>
                        </div>
                    </div>

                    <div class="stat-card stat-card-warning">
                        <div class="stat-icon">
                            <i class="fas fa-sitemap"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-label">组织</div>
                            <div class="stat-value" id="organizationCount">0</div>
                        </div>
                    </div>
                </div>

                <!-- 搜索、筛选和操作区域 -->
                <div class="filter-section">
                    <div class="filter-row">
                        <div class="filter-left">
                            <!-- 搜索框 -->
                            <div class="search-box">
                                <input type="text" id="searchInput" placeholder="搜索姓名、身份证号、信用代码...">
                                <i class="fas fa-search"></i>
                            </div>

                            <!-- 筛选器 -->
                            <select id="typeFilter" class="filter-select">
                                <option value="">全部类型</option>
                                <option value="PERSON">人员</option>
                                <option value="SUPPLIER">供应商</option>
                                <option value="ORGANIZATION">组织</option>
                                <option value="PROCUREMENT_PROJECT">采购项目</option>
                            </select>

                            <select id="statusFilter" class="filter-select">
                                <option value="">全部状态</option>
                                <option value="active">正常</option>
                                <option value="duplicate">重复</option>
                                <option value="inactive">停用</option>
                            </select>

                            <button id="resetBtn" class="btn btn-secondary">
                                <i class="fas fa-redo"></i> 重置
                            </button>
                        </div>

                        <!-- 操作按钮 -->
                        <div class="filter-right">
                            <button id="duplicatesBtn" class="btn btn-secondary">
                                <i class="fas fa-copy"></i> 重复数据
                            </button>
                            <button id="exportBtn" class="btn btn-secondary">
                                <i class="fas fa-download"></i> 导出
                            </button>
                            <button id="createBtn" class="btn btn-primary">
                                <i class="fas fa-plus"></i> 新增主数据
                            </button>
                        </div>
                    </div>
                </div>

                <!-- 主数据列表表格 -->
                <div class="table-container">
                    <table class="table">
                        <thead>
                            <tr>
                                <th width="50">
                                    <input type="checkbox" id="selectAll">
                                </th>
                                <th class="sortable" data-sort="id">
                                    ID <i class="fas fa-sort"></i>
                                </th>
                                <th>类型</th>
                                <th>名称</th>
                                <th>关键标识</th>
                                <th>来源系统</th>
                                <th>版本</th>
                                <th class="sortable" data-sort="updateTime">
                                    更新时间 <i class="fas fa-sort"></i>
                                </th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody id="masterDataTableBody">
                            <!-- 数据行将通过JavaScript动态生成 -->
                        </tbody>
                    </table>

                    <!-- 分页器 -->
                    <div class="pagination-info">
                        <div>
                            显示 <span id="pageStart">0</span> 到 <span id="pageEnd">0</span> 条，共 <span id="totalCount">0</span> 条
                        </div>
                        <div class="pagination-controls">
                            <button id="prevPage">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <div id="pageNumbers" class="page-numbers">
                                <!-- 页码按钮将通过 JavaScript 动态生成 -->
                            </div>
                            <button id="nextPage">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                </div>
        </main>
    </div>

    <!-- 主数据详情模态框 -->
    <div id="detailModal" class="modal-overlay">
        <div class="modal-container modal-xl">
            <div class="modal-header">
                <h2 class="modal-title">
                    <i class="fas fa-info-circle"></i>
                    主数据详情
                </h2>
                <button id="closeDetailModalBtn" class="modal-close-btn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <!-- 基本信息 -->
                <div class="detail-section">
                    <h3 class="detail-section-title">基本信息</h3>
                    <div class="detail-grid">
                        <div class="detail-item">
                            <label>主数据ID</label>
                            <div id="detailId">-</div>
                        </div>
                        <div class="detail-item">
                            <label>实体类型</label>
                            <div id="detailEntityType">-</div>
                        </div>
                        <div class="detail-item">
                            <label>名称</label>
                            <div id="detailName">-</div>
                        </div>
                        <div class="detail-item">
                            <label>版本</label>
                            <div id="detailVersion">-</div>
                        </div>
                        <div class="detail-item">
                            <label>创建时间</label>
                            <div id="detailCreateTime">-</div>
                        </div>
                        <div class="detail-item">
                            <label>更新时间</label>
                            <div id="detailUpdateTime">-</div>
                        </div>
                    </div>
                </div>

                <!-- 实体详细信息 -->
                <div class="detail-section">
                    <h3 class="detail-section-title">详细信息</h3>
                    <div class="detail-grid" id="detailEntityInfo">
                        <!-- 根据实体类型动态生成 -->
                    </div>
                </div>

                <!-- 数据来源 -->
                <div class="detail-section">
                    <h3 class="detail-section-title">数据来源</h3>
                    <div id="detailSources" class="source-list">
                        <!-- 来源系统列表 -->
                    </div>
                </div>

                <!-- 变更历史 -->
                <div class="detail-section">
                    <h3 class="detail-section-title">变更历史</h3>
                    <div id="detailHistory" class="history-list">
                        <!-- 变更历史列表 -->
                    </div>
                </div>
            </div>
            
            <div class="modal-footer">
                <button id="closeDetailBtn" class="btn btn-secondary">关闭</button>
                <button id="editFromDetailBtn" class="btn btn-primary">
                    <i class="fas fa-edit"></i> 编辑
                </button>
            </div>
        </div>
    </div>

    <!-- 创建/编辑主数据模态框 -->
    <div id="createModal" class="modal-overlay">
        <div class="modal-container modal-lg">
            <div class="modal-header">
                <h2 class="modal-title" id="createModalTitle">
                    <i class="fas fa-plus-circle"></i>新增主数据
                </h2>
                <button id="closeCreateModalBtn" class="modal-close-btn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="modal-body">
                <form id="masterDataForm">
                    <div class="form-group">
                        <label class="form-label required">实体类型</label>
                        <select id="entityType" class="form-control" required>
                            <option value="">请选择</option>
                            <option value="PERSON">人员</option>
                            <option value="SUPPLIER">供应商</option>
                            <option value="ORGANIZATION">组织</option>
                            <option value="PROCUREMENT_PROJECT">采购项目</option>
                        </select>
                    </div>
                    
                    <!-- 人员字段 -->
                    <div id="personFields" class="entity-fields" style="display: none;">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label required">姓名</label>
                                <input type="text" id="personName" class="form-control" placeholder="请输入姓名">
                            </div>
                            <div class="form-group">
                                <label class="form-label required">身份证号</label>
                                <input type="text" id="personIdCard" class="form-control" placeholder="请输入身份证号">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">手机号</label>
                                <input type="text" id="personPhone" class="form-control" placeholder="请输入手机号">
                            </div>
                            <div class="form-group">
                                <label class="form-label">邮箱</label>
                                <input type="email" id="personEmail" class="form-control" placeholder="请输入邮箱">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">部门</label>
                                <input type="text" id="personDepartment" class="form-control" placeholder="请输入部门">
                            </div>
                            <div class="form-group">
                                <label class="form-label">职位</label>
                                <input type="text" id="personPosition" class="form-control" placeholder="请输入职位">
                            </div>
                        </div>
                    </div>
                    
                    <!-- 供应商字段 -->
                    <div id="supplierFields" class="entity-fields" style="display: none;">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label required">供应商名称</label>
                                <input type="text" id="supplierName" class="form-control" placeholder="请输入供应商名称">
                            </div>
                            <div class="form-group">
                                <label class="form-label required">统一社会信用代码</label>
                                <input type="text" id="supplierCreditCode" class="form-control" placeholder="请输入信用代码">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">法定代表人</label>
                                <input type="text" id="supplierLegalPerson" class="form-control" placeholder="请输入法定代表人">
                            </div>
                            <div class="form-group">
                                <label class="form-label">联系电话</label>
                                <input type="text" id="supplierPhone" class="form-control" placeholder="请输入联系电话">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">注册地址</label>
                            <input type="text" id="supplierAddress" class="form-control" placeholder="请输入注册地址">
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">注册资本（万元）</label>
                                <input type="number" id="supplierCapital" class="form-control" placeholder="请输入注册资本">
                            </div>
                            <div class="form-group">
                                <label class="form-label">成立日期</label>
                                <input type="date" id="supplierEstablishDate" class="form-control">
                            </div>
                        </div>
                    </div>
                    
                    <!-- 组织字段 -->
                    <div id="organizationFields" class="entity-fields" style="display: none;">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label required">组织名称</label>
                                <input type="text" id="orgName" class="form-control" placeholder="请输入组织名称">
                            </div>
                            <div class="form-group">
                                <label class="form-label required">组织代码</label>
                                <input type="text" id="orgCode" class="form-control" placeholder="请输入组织代码">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">上级组织</label>
                                <input type="text" id="orgParent" class="form-control" placeholder="请输入上级组织">
                            </div>
                            <div class="form-group">
                                <label class="form-label">组织类型</label>
                                <select id="orgType" class="form-control">
                                    <option value="">请选择</option>
                                    <option value="DEPARTMENT">部门</option>
                                    <option value="COLLEGE">学院</option>
                                    <option value="CENTER">中心</option>
                                    <option value="OFFICE">办公室</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">负责人</label>
                                <input type="text" id="orgLeader" class="form-control" placeholder="请输入负责人">
                            </div>
                            <div class="form-group">
                                <label class="form-label">联系电话</label>
                                <input type="text" id="orgPhone" class="form-control" placeholder="请输入联系电话">
                            </div>
                        </div>
                    </div>
                    
                    <!-- 采购项目字段 -->
                    <div id="projectFields" class="entity-fields" style="display: none;">
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label required">项目名称</label>
                                <input type="text" id="projectName" class="form-control" placeholder="请输入项目名称">
                            </div>
                            <div class="form-group">
                                <label class="form-label required">项目编号</label>
                                <input type="text" id="projectCode" class="form-control" placeholder="请输入项目编号">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">项目金额（万元）</label>
                                <input type="number" id="projectAmount" class="form-control" placeholder="请输入项目金额">
                            </div>
                            <div class="form-group">
                                <label class="form-label">采购方式</label>
                                <select id="projectMethod" class="form-control">
                                    <option value="">请选择</option>
                                    <option value="PUBLIC_BIDDING">公开招标</option>
                                    <option value="INVITATION_BIDDING">邀请招标</option>
                                    <option value="COMPETITIVE_NEGOTIATION">竞争性谈判</option>
                                    <option value="SINGLE_SOURCE">单一来源</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label class="form-label">项目负责人</label>
                                <input type="text" id="projectLeader" class="form-control" placeholder="请输入项目负责人">
                            </div>
                            <div class="form-group">
                                <label class="form-label">项目状态</label>
                                <select id="projectStatus" class="form-control">
                                    <option value="">请选择</option>
                                    <option value="PLANNING">计划中</option>
                                    <option value="BIDDING">招标中</option>
                                    <option value="EXECUTING">执行中</option>
                                    <option value="COMPLETED">已完成</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">来源系统</label>
                        <input type="text" id="sourceSystem" class="form-control" placeholder="例如: 人事系统">
                        <small class="form-text">数据来源的系统名称</small>
                    </div>
                </form>
            </div>
            
            <div class="modal-footer">
                <button id="cancelCreateBtn" class="btn btn-secondary">取消</button>
                <button id="submitCreateBtn" class="btn btn-primary">
                    <i class="fas fa-check"></i> 保存
                </button>
            </div>
        </div>
    </div>

    <!-- 重复数据模态框 -->
    <div id="duplicatesModal" class="modal-overlay">
        <div class="modal-container modal-lg">
            <div class="modal-header">
                <h2 class="modal-title">
                    <i class="fas fa-copy"></i>重复数据识别
                </h2>
                <button class="modal-close-btn" onclick="masterDataPage.closeDuplicatesModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="duplicatesContent">
                    <!-- 重复数据内容将通过JavaScript动态生成 -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="masterDataPage.closeDuplicatesModal()">关闭</button>
            </div>
        </div>
    </div>

    <script src="js/common.js"></script>
    <script src="js/components.js"></script>
    <script src="js/master-data-service.js"></script>
    <script src="js/master-data-management.js"></script>
</body>
</html>
