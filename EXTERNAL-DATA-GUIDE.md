# 外部数据接入功能使用指南

## 功能概述

外部数据接入模块用于管理和配置各种外部数据源的接入，支持API、文件、系统三种接入方式。

## 新增数据接入功能

### 功能特性

✅ **支持三种接入类型**
- API接入：通过REST API获取数据
- 文件接入：导入Excel、CSV、JSON、XML等文件
- 系统接入：对接数据库、Web Service、消息队列等

✅ **灵活的同步配置**
- 实时同步
- 每小时同步
- 每日同步
- 每周同步
- 每月同步
- 手动同步

✅ **完整的配置管理**
- 认证配置（Basic Auth、Bearer Token、API Key）
- 文件格式配置
- 系统连接配置
- 目标表映射

## 使用步骤

### 1. 打开外部数据接入页面

访问 `external-data.html` 页面

### 2. 点击"新增接入"按钮

页面右上角的蓝色按钮

### 3. 填写基本信息

**必填项**：
- 接入名称：例如"教务系统学生数据接入"
- 接入类型：选择API、文件或系统
- 数据源名称：例如"教务管理系统"
- 同步频率：选择合适的同步频率

**选填项**：
- 描述：接入的详细说明

### 4. 配置接入参数

根据选择的接入类型，填写对应的配置：

#### API接入配置
- **API地址**：完整的API URL
- **请求方法**：GET/POST/PUT
- **认证方式**：
  - 无需认证
  - Basic Auth
  - Bearer Token
  - API Key
- **认证凭证**：根据认证方式填写

#### 文件接入配置
- **文件类型**：Excel/CSV/JSON/XML
- **文件路径**：服务器上的文件存储路径
- **编码格式**：UTF-8/GBK/GB2312

#### 系统接入配置
- **系统类型**：数据库/Web Service/消息队列
- **连接地址**：系统连接URL
- **用户名**：登录用户名
- **密码**：登录密码

### 5. 配置同步设置

- **同步频率**：选择数据同步的频率
- **执行时间**：对于每日/每周/每月同步，设置具体执行时间
- **目标表**：数据写入的目标表名
- **自动启动**：勾选后创建完成即开始同步

### 6. 提交创建

点击"创建"按钮完成配置

## 配置示例

### 示例1：API接入 - 教育部学籍数据

```
基本信息：
- 接入名称：教育部学籍数据接入
- 接入类型：API接入
- 数据源名称：教育部学籍系统
- 描述：同步学生学籍信息

API配置：
- API地址：https://api.moe.gov.cn/student/list
- 请求方法：GET
- 认证方式：Bearer Token
- 认证凭证：your_token_here

同步配置：
- 同步频率：每日
- 执行时间：06:00
- 目标表：ods_student_info
- 自动启动：是
```

### 示例2：文件接入 - 银行对账单

```
基本信息：
- 接入名称：银行对账单导入
- 接入类型：文件接入
- 数据源名称：工商银行
- 描述：每月导入银行对账单

文件配置：
- 文件类型：Excel (xlsx/xls)
- 文件路径：/data/import/bank/
- 编码格式：UTF-8

同步配置：
- 同步频率：每月
- 执行时间：09:00
- 目标表：ods_bank_statement
- 自动启动：是
```

### 示例3：系统接入 - 科研管理系统

```
基本信息：
- 接入名称：科研管理系统对接
- 接入类型：系统接入
- 数据源名称：科研管理系统
- 描述：实时同步科研项目数据

系统配置：
- 系统类型：数据库
- 连接地址：jdbc:mysql://192.168.1.100:3306/research
- 用户名：research_user
- 密码：********

同步配置：
- 同步频率：实时
- 目标表：ods_research_projects
- 自动启动：是
```

## 功能说明

### 统计信息

页面顶部显示四个统计卡片：
- **接入总数**：所有配置的接入数量
- **运行中**：当前正在运行的接入数量
- **今日同步**：今天已执行同步的接入数量
- **同步失败**：同步失败的接入数量

### 标签页筛选

- **全部接入**：显示所有接入
- **API接入**：只显示API类型
- **文件接入**：只显示文件类型
- **系统接入**：只显示系统类型

### 搜索和筛选

- **搜索框**：按接入名称或数据源搜索
- **状态筛选**：按运行状态筛选（运行中/已停止/失败）

### 操作按钮

每个接入记录提供以下操作：
- **查看**：查看接入详情
- **立即同步**：手动触发一次同步
- **编辑**：修改接入配置
- **启动/停止**：切换接入状态

## 数据持久化

所有创建的接入配置会自动保存到浏览器的 localStorage 中，刷新页面后数据不会丢失。

## 注意事项

1. **必填项验证**：所有标记为必填的字段必须填写
2. **认证信息安全**：认证凭证会保存在本地，请注意安全
3. **同步频率选择**：根据数据更新频率合理选择同步频率
4. **目标表命名**：建议使用规范的表名（如：ods_、dwd_前缀）
5. **测试连接**：创建前建议先测试连接是否正常

## 后续功能

计划中的功能：
- [ ] 连接测试功能
- [ ] 数据预览功能
- [ ] 字段映射配置
- [ ] 数据转换规则
- [ ] 同步日志查看
- [ ] 错误重试机制
- [ ] 批量导入配置
- [ ] 配置导出/导入

## 技术支持

如有问题，请查看：
- 浏览器控制台日志
- 接入状态和错误信息
- 同步历史记录

---

**版本**: 1.0.0  
**更新时间**: 2024-10-25
